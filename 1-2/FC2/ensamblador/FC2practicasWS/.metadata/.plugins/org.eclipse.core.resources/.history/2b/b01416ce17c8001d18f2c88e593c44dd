/*---------------------------------------------------------------------
**
**  Fichero:
**    fun_asm.c  19/10/2022
**
**    (c) Daniel Báscones García
**    Fundamentos de Computadores II
**    Facultad de Informática. Universidad Complutense de Madrid
**
**  Propósito:
**    Fichero de código para la práctica 4
**
**-------------------------------------------------------------------*/
.extern _stack
.data
.bss



.text
.extern i_sqrt
.global eucl_dist
.extern mul
.global guardar
.extern main



//rellenar con directivas .extern y .global
//con las funciones apropiadas

//int eucl_dist(int *w, int size);

eucl_dist:
	//lw a0, W
	//la a1, size
	//PROLOGO
	addi sp, sp, -28
	sw ra, 24(sp)
	sw s0, 20(sp)
	sw s1, 16(sp)
	sw s2, 12(sp)
	sw s3, 8(sp)
	sw s4, 4(sp)
	sw s5, 0(sp)

	li s2, 0     		//acc=0
	li s3, 0   			//i=0
	mv s4, a0			// wi en a4
	mv s5, a1
	j for
	for:
		bge s3, s5, efor 	// while i< size
		mv a0,s4
		slli t0, s3, 2   	//i*4
		add t1, s4, t0		//dir base wi
		lw t2, 0(t1)		//wi

		//mv a1, t2
		mv a0, t2			//a0 = wi
		mv a1, a0			//a1 = wi
		call mul			//llamamos a mul
							//a0=mul
		add s2, s2, a0		//acc += mul wi
		addi s3, s3, 1		//i++
		j for
	efor:

		mv a0, s2			//a0=acc
		lw ra, 24(sp)		//epílogo
		lw s0, 20(sp)
		lw s1, 16(sp)
		lw s2, 12(sp)
		lw s3, 8(sp)
		lw s4, 4(sp)
		lw s5, 0(sp)
		addi sp, sp, 28
		ret
		//mv s2, zero
		//mv s3, zero

    //recibo dirección de W en a0, y tamaño N en a1
    //realizo los cálculos pertinentes
    //devuelvo el resultado en a0


guardar:
	//lb a0, valor
	//lb a1, ubicacion
	mv a1, a0
	sb a0, 0(a1)
	ret


    //recibo el valor en a0, y la dirección destino en a1
    //asegurarse que sólo se guarda UN BYTE!!
